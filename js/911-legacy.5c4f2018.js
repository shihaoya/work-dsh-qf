"use strict";(self["webpackChunkwork_qianfeng"]=self["webpackChunkwork_qianfeng"]||[]).push([[911],{5911:function(t,n,i){i.r(n),i.d(n,{default:function(){return d}});var c=function(){var t=this,n=t.$createElement,i=t._self._c||n;return i("div",{staticClass:"cart-box"},[t._l(t.productsList,(function(n){return i("van-card",{attrs:{num:n.count,price:(n.price/100).toFixed(2),desc:n.descriptions,title:n.name,thumb:n.coverImg},scopedSlots:t._u([{key:"footer",fn:function(){return[i("van-button",{attrs:{size:"mini"},on:{click:function(i){return t.add(n)}}},[t._v("增加")]),i("van-button",{attrs:{size:"mini"},on:{click:function(i){return t.reduce(n)}}},[t._v("减少")])]},proxy:!0}],null,!0)})})),i("van-submit-bar",{staticStyle:{bottom:"50px"},attrs:{price:t.sumPrice,"button-text":"提交订单"},on:{submit:t.onSubmitOrder}})],2)},o=[],e=(i(1539),i(4747),i(8862),i(8783),i(3948),i(8309),i(7327),i(6977),i(525)),r={name:"Cart",data:function(){return{productsList:[],proId:1,cartList:JSON.parse(localStorage.getItem("cartProductsList")||"[]")}},computed:{sumPrice:function(){var t=0;return 0!==this.productsList.length&&this.productsList.forEach((function(n){t+=n.price*n.count})),t}},watch:{productsList:{deep:!0,handler:function(){var t=[];this.productsList.forEach((function(n){t.push({id:n._id,count:n.count})})),this.cartList=t,localStorage.setItem("cartProductsList",JSON.stringify(this.cartList))}}},mounted:function(){0===this.cartList.length&&this.$toast("您的购物车空空如也！")},created:function(){var t=this,n=[];this.cartList.forEach((function(t){n.push(new Promise((function(n,i){(0,e.FO)(t.id).then((function(t){n(t)})).catch((function(t){i(t)}))})))})),Promise.all(n).then((function(n){n.forEach((function(n,i){n.id=t.proId++,n.count=t.cartList[i].count})),t.productsList=n})).catch((function(t){console.log(t)}))},methods:{add:function(t){t.count++,t.count>t.quantity&&(this.$toast.fail("已经是最大数量"),t.count--)},reduce:function(t){var n=this;t.count--,t.count<=0&&this.$dialog.confirm({title:"确认移出购物车吗？",message:"将商品 ".concat(t.name," 移出购物车")}).then((function(){n.productsList=n.productsList.filter((function(n){return n.id!==t.id&&n.name!==t.name}))})).catch((function(){t.count++}))},onSubmitOrder:function(){var t=this;0!==this.productsList.length?this.$dialog.confirm({title:"确认提交订单吗",message:"共需支付".concat((this.sumPrice/100).toFixed(2),"元")}).then((function(){t.productsList=[],t.$dialog.alert({message:"支付成功，购物车已被清空",theme:"round-button"})})).catch((function(){t.$dialog.alert({message:"取消支付成功",theme:"round-button"})})):this.$dialog.alert({message:"购物车已空，无需提交订单，速去选购吧",theme:"round-button"})}}},s=r,u=i(1001),a=(0,u.Z)(s,c,o,!1,null,"3763d2a8",null),d=a.exports}}]);
//# sourceMappingURL=911-legacy.5c4f2018.js.map