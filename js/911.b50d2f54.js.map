{"version":3,"file":"js/911.b50d2f54.js","mappings":"sKAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,YAAY,CAACN,EAAIO,GAAIP,EAAgB,cAAE,SAASQ,GAAM,OAAOJ,EAAG,WAAW,CAACK,MAAM,CAAC,IAAMD,EAAKE,MAAM,OAASF,EAAKG,MAAQ,KAAKC,QAAQ,GAAG,KAAOJ,EAAKK,aAAa,MAAQL,EAAKM,KAAK,MAAQN,EAAKO,UAAUC,YAAYhB,EAAIiB,GAAG,CAAC,CAACC,IAAI,SAASC,GAAG,WAAW,MAAO,CAACf,EAAG,aAAa,CAACK,MAAM,CAAC,KAAO,QAAQW,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOrB,EAAIsB,IAAId,MAAS,CAACR,EAAIuB,GAAG,QAAQnB,EAAG,aAAa,CAACK,MAAM,CAAC,KAAO,QAAQW,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOrB,EAAIwB,OAAOhB,MAAS,CAACR,EAAIuB,GAAG,UAAUE,OAAM,IAAO,MAAK,QAAUrB,EAAG,iBAAiB,CAACsB,YAAY,CAAC,OAAS,QAAQjB,MAAM,CAAC,MAAQT,EAAI2B,SAAS,cAAc,QAAQP,GAAG,CAAC,OAASpB,EAAI4B,kBAAkB,IACvvBC,EAAkB,G,SCsBtB,GACAf,KAAAA,OACAgB,OACA,OACAC,aAAAA,GACAC,MAAAA,EACAC,SAAAA,KAAAA,MAAAA,aAAAA,QAAAA,qBAAAA,QAGAC,SAAAA,CACAP,WACA,QAMA,OALA,8BACA,+BACAQ,GAAAA,EAAAA,MAAAA,EAAAA,SAGA,IAGAC,MAAAA,CACAL,aAAAA,CACAM,MAAAA,EACAC,UACA,WACA,+BACAC,EAAAA,KAAAA,CACAC,GAAAA,EAAAA,IACA9B,MAAAA,EAAAA,WAGA,gBACA+B,aAAAA,QAAAA,mBAAAA,KAAAA,UAAAA,KAAAA,cAIAC,UACA,0BACA,2BAGAC,UACA,WACA,2BACAC,EAAAA,KAAAA,IAAAA,SAAAA,CAAAA,EAAAA,MACAC,EAAAA,EAAAA,IAAAA,EAAAA,IAAAA,MAAAA,IACAC,EAAAA,MACAC,OAAAC,IACAC,EAAAA,aAIAC,QAAAA,IAAAA,GAAAA,MAAAA,IACAC,EAAAA,SAAAA,CAAAA,EAAAA,KACA3C,EAAAA,GAAAA,KAAAA,QACAA,EAAAA,MAAAA,KAAAA,SAAAA,GAAAA,SAEA,uBACAuC,OAAAC,IACAI,QAAAA,IAAAA,OAGAC,QAAAA,CACA/B,IAAAA,GACAd,EAAAA,QACA,qBACA,4BACAA,EAAAA,UAGAgB,OAAAA,GACAhB,EAAAA,QACA,YACA,sBACA8C,MAAAA,YACAC,QAAAA,OAAAA,EAAAA,eACAC,MAAA,KACA,iFACAT,OAAA,KACAvC,EAAAA,YAIAoB,gBACA,6BAOA,sBACA0B,MAAAA,UACAC,QAAAA,QAAAA,KAAAA,SAAAA,KAAAA,QAAAA,QAEAC,MAAA,KACA,qBACA,oBACAD,QAAAA,eACAE,MAAAA,oBAGAV,OAAA,KACA,oBACAQ,QAAAA,SACAE,MAAAA,oBApBA,oBACAF,QAAAA,qBACAE,MAAAA,oBC9G0Q,I,UCQtQC,GAAY,OACd,EACA3D,EACA8B,GACA,EACA,KACA,WACA,MAIF,EAAe6B,EAAiB","sources":["webpack://work-qianfeng/./src/views/Cart/index.vue?5d3c","webpack://work-qianfeng/src/views/Cart/index.vue","webpack://work-qianfeng/./src/views/Cart/index.vue?4235","webpack://work-qianfeng/./src/views/Cart/index.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"cart-box\"},[_vm._l((_vm.productsList),function(item){return _c('van-card',{attrs:{\"num\":item.count,\"price\":(item.price / 100).toFixed(2),\"desc\":item.descriptions,\"title\":item.name,\"thumb\":item.coverImg},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [_c('van-button',{attrs:{\"size\":\"mini\"},on:{\"click\":function($event){return _vm.add(item)}}},[_vm._v(\"增加\")]),_c('van-button',{attrs:{\"size\":\"mini\"},on:{\"click\":function($event){return _vm.reduce(item)}}},[_vm._v(\"减少\")])]},proxy:true}],null,true)})}),_c('van-submit-bar',{staticStyle:{\"bottom\":\"50px\"},attrs:{\"price\":_vm.sumPrice,\"button-text\":\"提交订单\"},on:{\"submit\":_vm.onSubmitOrder}})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"cart-box\">\r\n    <van-card\r\n        v-for=\"item in productsList\"\r\n        :num=\"item.count\"\r\n        :price=\"(item.price / 100).toFixed(2)\"\r\n        :desc=\"item.descriptions\"\r\n        :title=\"item.name\"\r\n        :thumb=\"item.coverImg\"\r\n    >\r\n      <template #footer>\r\n        <van-button size=\"mini\" @click=\"add(item)\">增加</van-button>\r\n        <van-button size=\"mini\" @click=\"reduce(item)\">减少</van-button>\r\n      </template>\r\n    </van-card>\r\n    <van-submit-bar :price=\"sumPrice\" button-text=\"提交订单\" @submit=\"onSubmitOrder\" style=\"bottom: 50px;\"/>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport {reqProductsDetail} from '@/api'\r\n\r\nexport default {\r\n  name: 'Cart',\r\n  data() {\r\n    return {\r\n      productsList: [],\r\n      proId: 1,\r\n      cartList: JSON.parse(localStorage.getItem('cartProductsList') || '[]'),\r\n    }\r\n  },\r\n  computed: {\r\n    sumPrice() {\r\n      let sum = 0\r\n      if (this.productsList.length !== 0) {\r\n        this.productsList.forEach(item => {\r\n          sum += item.price * item.count\r\n        })\r\n      }\r\n      return sum\r\n    }\r\n  },\r\n  watch: {\r\n    productsList: {\r\n      deep: true,\r\n      handler() {\r\n        const tempArr = []\r\n        this.productsList.forEach(item => {\r\n          tempArr.push({\r\n            id: item._id,\r\n            count: item.count,\r\n          })\r\n        })\r\n        this.cartList = tempArr\r\n        localStorage.setItem('cartProductsList', JSON.stringify(this.cartList))\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    if (this.cartList.length === 0) {\r\n      this.$toast('您的购物车空空如也！')\r\n    }\r\n  },\r\n  created() {\r\n    const reqList = []\r\n    this.cartList.forEach(item => {\r\n      reqList.push(new Promise((resolve, reject) => {\r\n        reqProductsDetail(item.id).then((res) => {\r\n          resolve(res)\r\n        }).catch(err => {\r\n          reject(err)\r\n        })\r\n      }))\r\n    })\r\n    Promise.all(reqList).then(res => {\r\n      res.forEach((item, index) => {\r\n        item.id = this.proId++\r\n        item.count = this.cartList[index].count\r\n      })\r\n      this.productsList = res\r\n    }).catch(err => {\r\n      console.log(err)\r\n    })\r\n  },\r\n  methods: {\r\n    add(item) {\r\n      item.count++\r\n      if (item.count > item.quantity) {\r\n        this.$toast.fail('已经是最大数量')\r\n        item.count--\r\n      }\r\n    },\r\n    reduce(item) {\r\n      item.count--\r\n      if (item.count <= 0) {\r\n        this.$dialog.confirm({\r\n          title: '确认移出购物车吗？',\r\n          message: `将商品 ${item.name} 移出购物车`,\r\n        }).then(() => {\r\n          this.productsList = this.productsList.filter(item2 => (item2.id !== item.id && item2.name !== item.name))\r\n        }).catch(() => {\r\n          item.count++\r\n        })\r\n      }\r\n    },\r\n    onSubmitOrder() {\r\n      if(this.productsList.length === 0) {\r\n        this.$dialog.alert({\r\n          message: '购物车已空，无需提交订单，速去选购吧',\r\n          theme: 'round-button',\r\n        })\r\n        return\r\n      }\r\n      this.$dialog.confirm({\r\n        title: '确认提交订单吗',\r\n        message: `共需支付${(this.sumPrice / 100).toFixed(2)}元`,\r\n      })\r\n      .then(() => {\r\n        this.productsList = []\r\n        this.$dialog.alert({\r\n          message: '支付成功，购物车已被清空',\r\n          theme: 'round-button',\r\n        })\r\n      })\r\n      .catch(() => {\r\n        this.$dialog.alert({\r\n          message: '取消支付成功',\r\n          theme: 'round-button',\r\n        })\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.cart-box {\r\n  padding-bottom: 50px;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=3763d2a8&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=3763d2a8&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3763d2a8\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_l","item","attrs","count","price","toFixed","descriptions","name","coverImg","scopedSlots","_u","key","fn","on","$event","add","_v","reduce","proxy","staticStyle","sumPrice","onSubmitOrder","staticRenderFns","data","productsList","proId","cartList","computed","sum","watch","deep","handler","tempArr","id","localStorage","mounted","created","reqList","reqProductsDetail","resolve","catch","err","reject","Promise","res","console","methods","title","message","then","theme","component"],"sourceRoot":""}